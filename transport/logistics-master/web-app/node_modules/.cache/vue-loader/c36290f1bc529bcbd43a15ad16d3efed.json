{"remainingRequest":"D:\\桌面文件\\logistics-master\\logistics-master\\web-app\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\桌面文件\\logistics-master\\logistics-master\\web-app\\src\\views\\basics\\Employee.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\桌面文件\\logistics-master\\logistics-master\\web-app\\src\\views\\basics\\Employee.vue","mtime":1620229219000},{"path":"D:\\桌面文件\\logistics-master\\logistics-master\\web-app\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1686845412424},{"path":"D:\\桌面文件\\logistics-master\\logistics-master\\web-app\\node_modules\\vue-loader\\lib\\index.js","mtime":1686845393772}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7RGVsZXRlRW1wbG95ZWVCeUlkLCBGaW5kQWxsRW1wbG95ZWUsIFNhdmVFbXBsb3llZX0gZnJvbSAiQC9hcGkvZW1wbG95ZWUiOwppbXBvcnQge0ZpbmRBbGxXYXJlaG91c2V9IGZyb20gIi4uLy4uL2FwaS93YXJlaG91c2UiOwoKY29uc3QgY29sdW1ucyA9IFsKICB7CiAgICB0aXRsZTogJ+WQjeWtlycsCiAgICBkYXRhSW5kZXg6ICduYW1lJywKICAgIHNjb3BlZFNsb3RzOiB7Y3VzdG9tUmVuZGVyOiAnbmFtZSd9LAogIH0sCiAgewogICAgdGl0bGU6ICfmgKfliKsnLAogICAgZGF0YUluZGV4OiAnZ2VuZGVyJywKICAgIHNjb3BlZFNsb3RzOiB7Y3VzdG9tUmVuZGVyOiAnZ2VuZGVyJ30sCiAgfSwKICB7CiAgICB0aXRsZTogJ+aJgOWcqOmDqOmXqCcsCiAgICBkYXRhSW5kZXg6ICdkZXBhcnRtZW50JywKICAgIHNjb3BlZFNsb3RzOiB7Y3VzdG9tUmVuZGVyOiAnZGVwYXJ0bWVudCd9LAogIH0sCiAgewogICAgdGl0bGU6ICfogZTns7vnlLXor50nLAogICAgZGF0YUluZGV4OiAncGhvbmUnLAogICAgc2NvcGVkU2xvdHM6IHtjdXN0b21SZW5kZXI6ICdwaG9uZSd9LAogIH0sCiAgewogICAgdGl0bGU6ICfouqvku73or4EnLAogICAgZGF0YUluZGV4OiAnaWRDYXJkJywKICAgIHNjb3BlZFNsb3RzOiB7Y3VzdG9tUmVuZGVyOiAnaWRDYXJkJ30sCiAgfSwKICB7CiAgICB0aXRsZTogJ+WutuW6reS9j+WdgCcsCiAgICBkYXRhSW5kZXg6ICdhZGRyZXNzJywKICAgIHNjb3BlZFNsb3RzOiB7Y3VzdG9tUmVuZGVyOiAnYWRkcmVzcyd9LAogIH0sCiAgewogICAgdGl0bGU6ICfmk43kvZwnLAogICAgZGF0YUluZGV4OiAnb3BlcmF0aW9uJywKICAgIHNjb3BlZFNsb3RzOiB7Y3VzdG9tUmVuZGVyOiAnb3BlcmF0aW9uJ30sCiAgfSwKXTsKCmV4cG9ydCBkZWZhdWx0IHsKICBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgbG9hZGluZzogZmFsc2UsCiAgICAgIHdhcmVob3VzZUxpc3Q6IFtdLAogICAgICBmb3JtOiB7CiAgICAgICAgY2FjaGVEYXRhOiBbXSwKICAgICAgICBuYW1lOiAnJywKICAgICAgICBnZW5kZXI6ICfnlLfmgKcnLAogICAgICAgIHBob25lOiAnJywKICAgICAgICBkZXBhcnRtZW50OiAnJywKICAgICAgICBhZGRyZXNzOiAnJywKICAgICAgICBpZENhcmQ6ICcnLAogICAgICB9LAogICAgICB2aXNpYmxlOiBmYWxzZSwKICAgICAgZGF0YTogW10sCiAgICAgIGNvbHVtbnMsCiAgICAgIGVkaXRpbmdLZXk6ICcnLAogICAgfTsKICB9LAogIG1vdW50ZWQoKSB7CiAgICB0aGlzLmxvYWRUYWJsZURhdGEoKQogIH0sCiAgbWV0aG9kczogewoKICAgIGZpbmRBbGxXYXJlaG91c2UoKSB7CiAgICAgIEZpbmRBbGxXYXJlaG91c2UoKS50aGVuKChyZXMpID0+IHsKICAgICAgICB0aGlzLndhcmVob3VzZUxpc3QgPSByZXMuZGF0YQogICAgICB9KQogICAgfSwKCiAgICBsb2FkVGFibGVEYXRhKCkgewogICAgICB0aGlzLmxvYWRpbmcgPSB0cnVlCiAgICAgIHRoaXMuZmluZEFsbFdhcmVob3VzZSgpCiAgICAgIEZpbmRBbGxFbXBsb3llZSgpLnRoZW4oKHJlcykgPT4gewogICAgICAgIGlmIChyZXMuc3RhdHVzKSB7CiAgICAgICAgICB0aGlzLmRhdGEgPSByZXMuZGF0YQogICAgICAgICAgdGhpcy5jYWNoZURhdGEgPSByZXMuZGF0YS5tYXAoaXRlbSA9PiAoey4uLml0ZW19KSkKICAgICAgICB9CiAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7CiAgICAgICAgICB0aGlzLmxvYWRpbmcgPSBmYWxzZQogICAgICAgIH0sIDYwMCkKICAgICAgfSkKICAgIH0sCgogICAgc3VibWl0Rm9ybSgpIHsKICAgICAgU2F2ZUVtcGxveWVlKHRoaXMuZm9ybSkudGhlbigocmVzKSA9PiB7CiAgICAgICAgaWYgKHJlcy5zdGF0dXMpIHRoaXMuJG1lc3NhZ2Uuc3VjY2Vzcygn5ZGY5bel5L+h5oGv5o+Q5Lqk5oiQ5YqfJyk7CiAgICAgICAgdGhpcy52aXNpYmxlID0gZmFsc2UKICAgICAgICB0aGlzLmxvYWRUYWJsZURhdGEoKQogICAgICB9KQogICAgfSwKCiAgICBoYW5kbGVDaGFuZ2UodmFsdWUsIGlkLCBjb2x1bW4pIHsKICAgICAgY29uc3QgbmV3RGF0YSA9IFsuLi50aGlzLmRhdGFdOwogICAgICBjb25zdCB0YXJnZXQgPSBuZXdEYXRhLmZpbHRlcihpdGVtID0+IGlkID09PSBpdGVtLmlkKVswXTsKICAgICAgaWYgKHRhcmdldCkgewogICAgICAgIHRhcmdldFtjb2x1bW5dID0gdmFsdWU7CiAgICAgICAgdGhpcy5kYXRhID0gbmV3RGF0YTsKICAgICAgfQogICAgfSwKICAgIGVkaXQoaWQpIHsKICAgICAgY29uc3QgbmV3RGF0YSA9IFsuLi50aGlzLmRhdGFdOwogICAgICBjb25zdCB0YXJnZXQgPSBuZXdEYXRhLmZpbHRlcihpdGVtID0+IGlkID09PSBpdGVtLmlkKVswXTsKICAgICAgdGhpcy5lZGl0aW5nS2V5ID0gaWQ7CiAgICAgIGlmICh0YXJnZXQpIHsKICAgICAgICB0YXJnZXQuZWRpdGFibGUgPSB0cnVlOwogICAgICAgIHRoaXMuZGF0YSA9IG5ld0RhdGE7CiAgICAgIH0KICAgIH0sCgogICAgc2F2ZShpZCwgaW5kZXgpIHsKICAgICAgY29uc3QgbmV3RGF0YSA9IFsuLi50aGlzLmRhdGFdOwogICAgICBjb25zdCBuZXdDYWNoZURhdGEgPSBbLi4udGhpcy5jYWNoZURhdGFdOwogICAgICBjb25zdCB0YXJnZXQgPSBuZXdEYXRhLmZpbHRlcihpdGVtID0+IGlkID09PSBpdGVtLmlkKVswXTsKICAgICAgY29uc3QgdGFyZ2V0Q2FjaGUgPSBuZXdDYWNoZURhdGEuZmlsdGVyKGl0ZW0gPT4gaWQgPT09IGl0ZW0uaWQpWzBdOwogICAgICBpZiAodGFyZ2V0ICYmIHRhcmdldENhY2hlKSB7CiAgICAgICAgZGVsZXRlIHRhcmdldC5lZGl0YWJsZTsKICAgICAgICB0aGlzLmRhdGEgPSBuZXdEYXRhOwogICAgICAgIE9iamVjdC5hc3NpZ24odGFyZ2V0Q2FjaGUsIHRhcmdldCk7CiAgICAgICAgdGhpcy5jYWNoZURhdGEgPSBuZXdDYWNoZURhdGE7CiAgICAgIH0KICAgICAgdGhpcy5lZGl0aW5nS2V5ID0gJyc7CiAgICAgIFNhdmVFbXBsb3llZShuZXdEYXRhW2luZGV4XSkudGhlbigocmVzKSA9PiB7CiAgICAgICAgaWYgKHJlcy5zdGF0dXMpIHRoaXMuJG1lc3NhZ2Uuc3VjY2Vzcygi5L+h5oGv5L+d5a2Y5oiQ5YqfIikKICAgICAgfSkKICAgIH0sCiAgICBjYW5jZWwoaWQpIHsKICAgICAgY29uc3QgbmV3RGF0YSA9IFsuLi50aGlzLmRhdGFdOwogICAgICBjb25zdCB0YXJnZXQgPSBuZXdEYXRhLmZpbHRlcihpdGVtID0+IGlkID09PSBpdGVtLmlkKVswXTsKICAgICAgdGhpcy5lZGl0aW5nS2V5ID0gJyc7CiAgICAgIGlmICh0YXJnZXQpIHsKICAgICAgICBPYmplY3QuYXNzaWduKHRhcmdldCwgdGhpcy5jYWNoZURhdGEuZmlsdGVyKGl0ZW0gPT4gaWQgPT09IGl0ZW0uaWQpWzBdKTsKICAgICAgICBkZWxldGUgdGFyZ2V0LmVkaXRhYmxlOwogICAgICAgIHRoaXMuZGF0YSA9IG5ld0RhdGE7CiAgICAgIH0KICAgIH0sCiAgICBjb25maXJtKGlkKSB7CiAgICAgIERlbGV0ZUVtcGxveWVlQnlJZChpZCkudGhlbigocmVzKSA9PiB7CiAgICAgICAgaWYgKHJlcy5zdGF0dXMpIHRoaXMuJG1lc3NhZ2Uuc3VjY2VzcygnRGVsZXRlIHN1Y2Nlc3MnKTsKICAgICAgICB0aGlzLmxvYWRUYWJsZURhdGEoKQogICAgICB9KQogICAgfSwKICB9LAp9Owo="},{"version":3,"sources":["Employee.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAkFA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Employee.vue","sourceRoot":"src/views/basics","sourcesContent":["<template>\n  <div>\n    <a-button size=\"large\" class=\"editable-add-btn\" @click=\"visible = true\">\n      <a-icon type=\"plus\"/>\n      新增员工\n    </a-button>\n    <a-table :loading=\"loading\" :columns=\"columns\" :data-source=\"data\" bordered rowKey=\"id\">\n      <template\n          v-for=\"col in ['name', 'gender', 'phone','idCard','department', 'address']\"\n          :slot=\"col\"\n          slot-scope=\"text, record, index\"\n      >\n        <div :key=\"col\">\n          <a-input\n              v-if=\"record.editable\"\n              style=\"margin: -5px 0\"\n              :value=\"text\"\n              @change=\"e => handleChange(e.target.value, record.id, col)\"\n          />\n          <template v-else>\n            {{ text }}\n          </template>\n        </div>\n      </template>\n      <template slot=\"operation\" slot-scope=\"text, record, index\">\n        <div class=\"editable-row-operations\">\n        <span v-if=\"record.editable\">\n          <a @click=\"() => save(record.id, index)\">保存</a>\n          <a-popconfirm title=\"Sure to cancel?\" @confirm=\"() => cancel(record.id)\">\n            <a>取消</a>\n          </a-popconfirm>\n        </span>\n          <span v-else>\n          <a :disabled=\"editingKey !== ''\" @click=\"() => edit(record.id)\">编辑</a>\n        </span>\n          <a-popconfirm placement=\"top\" ok-text=\"Yes\" cancel-text=\"No\" @confirm=\"confirm(record.id)\">\n            <template slot=\"title\">\n              <p> 删除驾驶员信息后将无法恢复，确定要删除吗？ </p>\n            </template>\n            <a-button type=\"link\">删除</a-button>\n          </a-popconfirm>\n        </div>\n      </template>\n    </a-table>\n\n    <a-modal\n        title=\"Title\"\n        :visible=\"visible\"\n        @ok=\"submitForm\"\n        @cancel=\"visible = false\"\n    >\n      <a-form-model :model=\"form\">\n        <a-form-model-item label=\"姓名\">\n          <a-input v-model=\"form.name\" placeholder=\"请输入司机姓名\"/>\n        </a-form-model-item>\n        <a-form-model-item label=\"身份证号\">\n          <a-input v-model=\"form.idCard\" placeholder=\"请输入司机身份证信息\"/>\n        </a-form-model-item>\n        <a-form-model-item label=\"联系方式\">\n          <a-input v-model=\"form.phone\" placeholder=\"请输入手机号码\"/>\n        </a-form-model-item>\n        <a-form-model-item label=\"所在仓库\">\n          <a-select v-model=\"form.department\" v-for=\"(item,index) in warehouseList\" placeholder=\"请选择员工所在仓库\">\n            <a-select-option :value=\"item.name\">{{ item.name }}</a-select-option>\n          </a-select>\n        </a-form-model-item>\n        <a-form-model-item label=\"性别\">\n          <a-radio-group v-model=\"form.gender\">\n            <a-radio value=\"男性\">男性</a-radio>\n            <a-radio value=\"女性\">女性</a-radio>\n          </a-radio-group>\n        </a-form-model-item>\n        <a-form-model-item label=\"家庭住址\">\n          <a-input v-model=\"form.address\" type=\"textarea\"/>\n        </a-form-model-item>\n      </a-form-model>\n    </a-modal>\n\n  </div>\n</template>\n\n<script>\nimport {DeleteEmployeeById, FindAllEmployee, SaveEmployee} from \"@/api/employee\";\nimport {FindAllWarehouse} from \"../../api/warehouse\";\n\nconst columns = [\n  {\n    title: '名字',\n    dataIndex: 'name',\n    scopedSlots: {customRender: 'name'},\n  },\n  {\n    title: '性别',\n    dataIndex: 'gender',\n    scopedSlots: {customRender: 'gender'},\n  },\n  {\n    title: '所在部门',\n    dataIndex: 'department',\n    scopedSlots: {customRender: 'department'},\n  },\n  {\n    title: '联系电话',\n    dataIndex: 'phone',\n    scopedSlots: {customRender: 'phone'},\n  },\n  {\n    title: '身份证',\n    dataIndex: 'idCard',\n    scopedSlots: {customRender: 'idCard'},\n  },\n  {\n    title: '家庭住址',\n    dataIndex: 'address',\n    scopedSlots: {customRender: 'address'},\n  },\n  {\n    title: '操作',\n    dataIndex: 'operation',\n    scopedSlots: {customRender: 'operation'},\n  },\n];\n\nexport default {\n  data() {\n    return {\n      loading: false,\n      warehouseList: [],\n      form: {\n        cacheData: [],\n        name: '',\n        gender: '男性',\n        phone: '',\n        department: '',\n        address: '',\n        idCard: '',\n      },\n      visible: false,\n      data: [],\n      columns,\n      editingKey: '',\n    };\n  },\n  mounted() {\n    this.loadTableData()\n  },\n  methods: {\n\n    findAllWarehouse() {\n      FindAllWarehouse().then((res) => {\n        this.warehouseList = res.data\n      })\n    },\n\n    loadTableData() {\n      this.loading = true\n      this.findAllWarehouse()\n      FindAllEmployee().then((res) => {\n        if (res.status) {\n          this.data = res.data\n          this.cacheData = res.data.map(item => ({...item}))\n        }\n        setTimeout(() => {\n          this.loading = false\n        }, 600)\n      })\n    },\n\n    submitForm() {\n      SaveEmployee(this.form).then((res) => {\n        if (res.status) this.$message.success('员工信息提交成功');\n        this.visible = false\n        this.loadTableData()\n      })\n    },\n\n    handleChange(value, id, column) {\n      const newData = [...this.data];\n      const target = newData.filter(item => id === item.id)[0];\n      if (target) {\n        target[column] = value;\n        this.data = newData;\n      }\n    },\n    edit(id) {\n      const newData = [...this.data];\n      const target = newData.filter(item => id === item.id)[0];\n      this.editingKey = id;\n      if (target) {\n        target.editable = true;\n        this.data = newData;\n      }\n    },\n\n    save(id, index) {\n      const newData = [...this.data];\n      const newCacheData = [...this.cacheData];\n      const target = newData.filter(item => id === item.id)[0];\n      const targetCache = newCacheData.filter(item => id === item.id)[0];\n      if (target && targetCache) {\n        delete target.editable;\n        this.data = newData;\n        Object.assign(targetCache, target);\n        this.cacheData = newCacheData;\n      }\n      this.editingKey = '';\n      SaveEmployee(newData[index]).then((res) => {\n        if (res.status) this.$message.success(\"信息保存成功\")\n      })\n    },\n    cancel(id) {\n      const newData = [...this.data];\n      const target = newData.filter(item => id === item.id)[0];\n      this.editingKey = '';\n      if (target) {\n        Object.assign(target, this.cacheData.filter(item => id === item.id)[0]);\n        delete target.editable;\n        this.data = newData;\n      }\n    },\n    confirm(id) {\n      DeleteEmployeeById(id).then((res) => {\n        if (res.status) this.$message.success('Delete success');\n        this.loadTableData()\n      })\n    },\n  },\n};\n</script>\n<style scoped>\n\n.editable-add-btn {\n  margin-bottom: 15px;\n}\n\n.editable-row-operations a {\n  margin-right: 8px;\n}\n</style>\n"]}]}